**Как использовать фильтры с `/search`:**

1.  **Страна поиска:** Используйте параметр `filter` с ключом `country` и массивом значений `values` с двухбуквенными кодами стран.
2.  **Классификационные рубрики МПК (СПК):** Используйте параметр `filter` с ключом `classification.ipc` (для МПК) или `classification.cpc` (для СПК) и массивом значений `values` с кодами классификации.
3.  **Ретроспективность (глубина поиска):** Используйте параметр `filter` с ключом `date_published` (для даты публикации) или `application.filing_date` (для даты подачи заявки) и параметром `range` с условиями `gt`, `gte`, `lt`, или `lte`.

**Примеры запросов:**

**1. Поиск по стране, МПК и ретроспективности:**
```
POST /search
{
  "q": "ракета",
  "filter": {
    "country": {
      "values": ["RU", "US"]
    },
    "classification.ipc": {
      "values": ["F02K9/00", "F42B15/00"]
    },
    "date_published": {
      "range": {
        "gte": "20030101" // Начиная с 1 января 2003 года
      }
    }
  }
}
```
*   Этот запрос будет искать патенты по ключевому слову "ракета", у которых страна публикации - Россия (`RU`) или США (`US`).
*   В классификации МПК должно быть `F02K9/00` ИЛИ `F42B15/00`.
*   Дата публикации должна быть 1 января 2003 года или позже.

**2. Поиск по СПК и ретроспективности (с диапазоном дат):**
```
POST /search
{
  "q": "двигатель",
  "filter": {
    "classification.cpc": {
      "values": ["F02B", "F02C"] // подклассы СПК F02B и F02C
     },
     "application.filing_date": {
       "range": {
         "gt": "20100101", // Позже 1 января 2010
         "lt": "20200101"  // Ранее 1 января 2020
       }
      }
  }
}
```
*   Этот запрос ищет патенты по ключевому слову "двигатель"
*   СПК должен содержать подклассы `F02B` или `F02C`.
*   Дата подачи заявки должна быть между 1 января 2010 и 1 января 2020 года (не включая сами даты).

**3. Поиск по МПК, дате публикации, и включением фасетов**
```
POST /search
{
 "q": "космический аппарат",
  "include_facets": 1,
   "filter": {
    "classification.ipc": {
      "values": ["B64G1/00", "B64G1/22"]
    },
    "date_published": {
      "range": {
        "gte": "20150101"
      }
    }
  }
}
```

**Разбор параметров:**

*   **`q`:** Ваш основной поисковый запрос (например, "ракета", "двигатель").
*   **`filter`:** Объект, содержащий фильтры:
    *   `country`: Фильтр по стране. `values` - массив кодов стран (например, `["RU", "US", "DE"]`).
    *   `classification.ipc` / `classification.cpc`: Фильтр по кодам МПК/СПК. `values` - массив кодов (например, `["F02K9/00", "F42B15/00"]`, `["F02B", "F02C"]`). Можно использовать полные коды (`F02K9/00`) или их части (например, только подкласс `"F02K"`).
    *   `date_published` / `application.filing_date`: Фильтр по дате публикации или дате подачи заявки. Используется объект `range` с параметрами:
        *   `gt`: Больше чем.
        *   `gte`: Больше или равно.
        *   `lt`: Меньше чем.
        *   `lte`: Меньше или равно.
        *   Даты должны быть в формате `YYYYMMDD`.

**Важные замечания:**

*   **Логика "AND":** Все фильтры работают по логике "AND" (т.е. должны выполняться все условия).
*   **Комбинации:** Можно комбинировать любые фильтры в одном запросе.
*   **Усечение:** В полях `classification.ipc` и `classification.cpc` можно использовать усечения `*` для поиска по части кода.
*   **`include_facets`**: Если установить в значение `1`, то в результате будут возвращены также данные фасетов для фильтрации. Подробнее смотрите раздел 2.2.8
*   **Диапазон дат:** Можно задавать диапазоны дат с помощью `range` с условиями `gt`/`gte` и `lt`/`lte`.
*   **Ретроспективность:** Для ретроспективности просто задавайте дату отсечения с помощью `gte` для `date_published` или `application.filing_date`.

**Вывод:**

Метод `/search` предоставляет мощный механизм фильтрации по стране, классификации и ретроспективности. Используйте описанные параметры в соответствии с вашими потребностями.

